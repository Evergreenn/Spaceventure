<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="assets/js/phaser.min.js"></script>
    <title>r</title>
</head>
<body>

<script >

    const game = new Phaser.Game(1000, 600,Phaser.CANVAS, '', {
        preload: preload,
        create: create,
        update: update,
        render:render
    });

    const mvtSpeed = 300;
    const bulletSpeed = 800;
    const FireRate = 500;
    let player;
    let cursors;
    let weapon;
    let fireButton;
    let badGuy;

    function preload ()
    {
        this.load.image('spaceship', 'assets/imgs/triangle.png');
        this.load.image('spaceBackground', 'assets/imgs/space.png');
        this.load.image('bullet', 'assets/imgs/bullet.png');
        this.load.image('baddies', 'assets/imgs/baddies.png')
    }

    function create ()
    {
        this.background = this.add.tileSprite(0, 0, this.game.width, this.game.height, 'spaceBackground');
        this.background.autoScroll(-40, 0);

        badGuy = this.add.sprite(700, 300, 'baddies');
        badGuy.scale.setTo(0.1);
        game.physics.arcade.enable(badGuy);


        player = this.add.sprite(100, 300, 'spaceship');
        player.scale.setTo(0.1);
        player.rotation = 100;
        game.physics.arcade.enable(player);
        player.body.collideWorldBounds = true;

        cursors = this.input.keyboard.createCursorKeys();

        weapon = game.add.weapon(40, 'bullet');
        weapon.bulletAngleOffset = 0;
        weapon.bullets.setAll('scale.x', 0.3);
        weapon.bullets.setAll('scale.y', 0.3);
        weapon.fireAngle = Phaser.ANGLE_RIGHT;
        weapon.bulletKillType = Phaser.Weapon.KILL_WORLD_BOUNDS;
        weapon.bulletSpeed = bulletSpeed;
        weapon.fireRate = FireRate;
        weapon.trackSprite(player, 140, 10);

        fireButton = this.input.keyboard.addKey(Phaser.KeyCode.SPACEBAR);
    }

    function update ()
    {

        if (cursors.left.isDown)
        {
            player.body.velocity.x = -mvtSpeed;
            player.body.velocity.y = 0;
        }
        else if (cursors.right.isDown)
        {
            player.body.velocity.x = mvtSpeed;
            player.body.velocity.y = 0;


        }
        else if (cursors.up.isDown)
        {
            player.body.velocity.x = 0;
            player.body.velocity.y = -mvtSpeed;
        }
        else if (cursors.down.isDown)
        {
            player.body.velocity.x = 0;
            player.body.velocity.y = mvtSpeed;
        }
        else
        {
            player.body.velocity.x = 0;
            player.body.velocity.y = 0;
        }

        if(fireButton.isDown){
            weapon.fire();
        }

        game.physics.arcade.overlap(weapon.bullets, badGuy, collisionHandler, null, this);
    }

    function collisionHandler(bullet, alien)
    {

        bullet.kill();
        alien.kill();

        badGuy = this.add.sprite(getRandomArbitrary(100, 900), getRandomArbitrary(50, 550), 'baddies');
        badGuy.scale.setTo(0.1);
        game.physics.arcade.enable(badGuy);
    }

    function getRandomArbitrary(min, max) {
        return Math.random() * (max - min) + min;
    }

    function render() {


    }

</script>

</body>
</html>